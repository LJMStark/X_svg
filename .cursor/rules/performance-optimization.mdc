# 性能优化规范

## 批量处理策略

- 使用 [batch_process_tweets.py](mdc:batch_process_tweets.py) 进行批量处理
- 支持指定处理范围（start和count参数）
- 实现断点续传，跳过已处理的记录
- 逐条处理，避免内存占用过大

## API调用优化

- 智能速度限制：4秒间隔避免429错误
- 指数退避重试机制
- 故障转移支持（OpenRouter → Gemini）
- 统计API调用次数和成功率

## 内存管理

- 逐条读取和处理数据
- 及时释放不需要的对象
- 避免在内存中保存大量数据
- 使用生成器模式处理大文件

## 进度显示

- 使用tqdm库显示处理进度
- 实时显示成功/失败统计
- 预估剩余处理时间
- 显示当前处理的记录信息

## 错误恢复

- 单条记录失败不影响整体处理
- 记录失败原因和重试次数
- 支持手动跳过问题记录
- 提供详细的错误日志

## 配置优化

- 支持环境变量配置
- 命令行参数覆盖配置文件
- 灵活的输入输出路径配置
- 可配置的重试次数和间隔时间
description:
globs:
alwaysApply: true
---
